<!DOCTYPE html>
<html>
<head>
  <title>Loan Amortization</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
  body {
    font-family: 'Poppins', sans-serif;
    background-color: #f4f6f8;
    margin: 0;
    padding: 0;
  }

  nav {
    background-color: #2c3e50;
    padding: 14px 20px;
  }

  nav a {
    color: #ecf0f1;
    margin-right: 20px;
    text-decoration: none;
    font-weight: 600;
    font-size: 16px;
  }

  h1 {
    text-align: center;
    color: #34495e;
    margin-top: 30px;
  }

  table {
    width: 90%;
    margin: 30px auto;
    border-collapse: collapse;
    background-color: #ffffff;
    border: 1px solid #ccc;
  }

  th, td {
    padding: 10px;
    text-align: center;
    border: 1px solid #ccc;
  }

  th {
    background-color: #2980b9;
    color: white;
    font-weight: 600;
  }

  tr:nth-child(even) {
    background-color: #f2f2f2;
  }

  tr:hover {
    background-color: #dff9fb;
  }
  </style>
</head>
<body>
  <nav>
    <a href="index.html">Add Notes</a>
    <a href="view-notes.html">View Notes</a>
    <a href="loan-amortization.html">Loan Amortization</a>
  </nav>

  <h1>Loan Amortization Schedule</h1>

  <table id="loan-table">
    <thead>
      <tr>
        <th>Month Start</th>
        <th>EMI</th>
        <th>Interest</th>
        <th>Principal</th>
        <th>Closing Principal</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const supabaseUrl = 'https://wzgchcvyzskespcfrjvi.supabase.co'
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6Z2NoY3Z5enNrZXNwY2ZyanZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE4NjQwNDEsImV4cCI6MjA1NzQ0MDA0MX0.UuAgu4quD9Vg80tOUSkfGJ4doOT0CUFEUeoHsiyeNZQ' // Keep your real key here
    const supabase = createClient(supabaseUrl, supabaseKey)

    function formatDate(dateStr) {
      const date = new Date(dateStr)
      const options = { day: '2-digit', month: 'short', year: '2-digit' }
      return date.toLocaleDateString('en-GB', options).replace(/ /g, '-')
    }

    async function loadData() {
      const { data, error } = await supabase
        .from('loan_amortization')
        .select('*')
        .order('month_start', { ascending: true })

      const tbody = document.querySelector('#loan-table tbody')

      if (error) {
        tbody.innerHTML = `<tr><td colspan="5">${error.message}</td></tr>`
        return
      }

      data.forEach(row => {
        const tr = document.createElement('tr')
        tr.innerHTML = `
          <td>${formatDate(row.month_start)}</td>
          <td>${row.emi}</td>
          <td>${row.interest_component}</td>
          <td>${row.principal_component}</td>
          <td>${row.closing_principal}</td>
        `
        tbody.appendChild(tr)
      })
    }

    loadData()
  </script>
</body>
</html>


    loadData()
  </script>
</body>
</html>
